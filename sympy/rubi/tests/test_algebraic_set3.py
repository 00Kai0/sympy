'''
test_algebraic_set3 contains: 1 Algebraic functions\1 Linear products\1.4 (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q
'''

# Integrands of the form x**m (a+b x)**n (c+d x)**p (e+f x)**q

# Integrands of the form x**m (a+b x)**n (c+d x)**p (e+f x)**q
assert rubi_integrate(x**3*(1+a*x)/(sqrt(a*x)*sqrt(1-a*x)), x) == -75/128*arcsin(1-2*a*x)/a**4-25/32*(a*x)**(3/2)*sqrt(1-a*x)/a**4-5/8*(a*x)**(5/2)*sqrt(1-a*x)/a**4-1/4*(a*x)**(7/2)*sqrt(1-a*x)/a**4-75/64*sqrt(a*x)*sqrt(1-a*x)/a**4
assert rubi_integrate(x**2*(1+a*x)/(sqrt(a*x)*sqrt(1-a*x)), x) == -11/16*arcsin(1-2*a*x)/a**3-11/12*(a*x)**(3/2)*sqrt(1-a*x)/a**3-1/3*(a*x)**(5/2)*sqrt(1-a*x)/a**3-11/8*sqrt(a*x)*sqrt(1-a*x)/a**3
assert rubi_integrate(x*(1+a*x)/(sqrt(a*x)*sqrt(1-a*x)), x) == -7/8*arcsin(1-2*a*x)/a**2-1/2*(a*x)**(3/2)*sqrt(1-a*x)/a**2-7/4*sqrt(a*x)*sqrt(1-a*x)/a**2
assert rubi_integrate((1+a*x)/(sqrt(a*x)*sqrt(1-a*x)), x) == -3/2*arcsin(1-2*a*x)/a-sqrt(a*x)*sqrt(1-a*x)/a
assert rubi_integrate((1+a*x)/(x*sqrt(a*x)*sqrt(1-a*x)), x) == -arcsin(1-2*a*x)-2*sqrt(1-a*x)/sqrt(a*x)
assert rubi_integrate((1+a*x)/(x**2*sqrt(a*x)*sqrt(1-a*x)), x) == -2/3*a*sqrt(1-a*x)/(a*x)**(3/2)-10/3*a*sqrt(1-a*x)/sqrt(a*x)
assert rubi_integrate((1+a*x)/(x**3*sqrt(a*x)*sqrt(1-a*x)), x) == -2/5*a**2*sqrt(1-a*x)/(a*x)**(5/2)-6/5*a**2*sqrt(1-a*x)/(a*x)**(3/2)-12/5*a**2*sqrt(1-a*x)/sqrt(a*x)
assert rubi_integrate((1+a*x)/(x**4*sqrt(a*x)*sqrt(1-a*x)), x) == -2/7*a**3*sqrt(1-a*x)/(a*x)**(7/2)-26/35*a**3*sqrt(1-a*x)/(a*x)**(5/2)-104/105*a**3*sqrt(1-a*x)/(a*x)**(3/2)-208/105*a**3*sqrt(1-a*x)/sqrt(a*x)
assert rubi_integrate((1+a*x)/(x**5*sqrt(a*x)*sqrt(1-a*x)), x) == -2/9*a**4*sqrt(1-a*x)/(a*x)**(9/2)-34/63*a**4*sqrt(1-a*x)/(a*x)**(7/2)-68/105*a**4*sqrt(1-a*x)/(a*x)**(5/2)-272/315*a**4*sqrt(1-a*x)/(a*x)**(3/2)-544/315*a**4*sqrt(1-a*x)/sqrt(a*x)

# Integrands of the form (a+b x)**n (c+d x)**(p/2) (e+f x) / x
assert rubi_integrate((a+b*x)**3*(e+f*x)*sqrt(c+d*x)/x, x) == 2/21*(3*b*d*e-2*b*c*f+2*a*d*f)*(a+b*x)**2*(c+d*x)**(3/2)/d**2+2/9*f*(a+b*x)**3*(c+d*x)**(3/2)/d+2/315*(c+d*x)**(3/2)*(2*(20*a**3*d**3*f+3*a**2*b*d**2*(45*d*e-16*c*f)-9*a*b**2*c*d*(7*d*e-4*c*f)+4*b**3*c**2*(3*d*e-2*c*f))+3*b*d*(21*a*b*d**2*e-4*(b*c-a*d)*(3*b*d*e-2*b*c*f+2*a*d*f))*x)/d**4-2*a**3*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)+2*a**3*e*sqrt(c+d*x)
assert rubi_integrate((a+b*x)**2*(e+f*x)*sqrt(c+d*x)/x, x) == 2/7*f*(a+b*x)**2*(c+d*x)**(3/2)/d+2/105*(c+d*x)**(3/2)*(2*(10*a**2*d**2*f-b**2*c*(7*d*e-4*c*f)+7*a*b*d*(5*d*e-2*c*f))+3*b*d*(7*b*d*e-4*b*c*f+4*a*d*f)*x)/d**3-2*a**2*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)+2*a**2*e*sqrt(c+d*x)
assert rubi_integrate((a+b*x)*(e+f*x)*sqrt(c+d*x)/x, x) == -2/15*(c+d*x)**(3/2)*(2*b*c*f-5*d*(b*e+a*f)-3*b*d*f*x)/d**2-2*a*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)+2*a*e*sqrt(c+d*x)
assert rubi_integrate((e+f*x)*sqrt(c+d*x)/x, x) == 2/3*f*(c+d*x)**(3/2)/d-2*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)+2*e*sqrt(c+d*x)
assert rubi_integrate((e+f*x)*sqrt(c+d*x)/(x*(a+b*x)), x) == -2*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)/a+2*(b*e-a*f)*arctanh(sqrt(b)*sqrt(c+d*x)/sqrt(b*c-a*d))*sqrt(b*c-a*d)/(a*b**(3/2))+2*f*sqrt(c+d*x)/b
assert rubi_integrate((e+f*x)*sqrt(c+d*x)/(x*(a+b*x)**2), x) == -2*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)/a**2+(2*b**2*c*e-a*d*(b*e+a*f))*arctanh(sqrt(b)*sqrt(c+d*x)/sqrt(b*c-a*d))/(a**2*b**(3/2)*sqrt(b*c-a*d))+(b*e-a*f)*sqrt(c+d*x)/(a*b*(a+b*x))
assert rubi_integrate((e+f*x)*sqrt(c+d*x)/(x*(a+b*x)**3), x) == 1/4*(8*b**3*c**2*e-12*a*b**2*c*d*e+3*a**2*b*d**2*e+a**3*d**2*f)*arctanh(sqrt(b)*sqrt(c+d*x)/sqrt(b*c-a*d))/(a**3*b**(3/2)*(b*c-a*d)**(3/2))-2*e*arctanh(sqrt(c+d*x)/sqrt(c))*sqrt(c)/a**3+1/2*(b*e-a*f)*sqrt(c+d*x)/(a*b*(a+b*x)**2)+1/4*(4*b**2*c*e-3*a*b*d*e-a**2*d*f)*sqrt(c+d*x)/(a**2*b*(b*c-a*d)*(a+b*x))

# Integrands of the form (a+b x)**(n/2) (c+d x)**p (e+f x) / x
assert rubi_integrate((c+d*x)**3*(e+f*x)*sqrt(a+b*x)/x, x) == 2/21*(3*b*d*e+2*b*c*f-2*a*d*f)*(a+b*x)**(3/2)*(c+d*x)**2/b**2+2/9*f*(a+b*x)**(3/2)*(c+d*x)**3/b-2/315*(a+b*x)**(3/2)*(2*(8*a**3*d**3*f-12*a**2*b*d**2*(d*e+3*c*f)-5*b**3*c**2*(27*d*e+4*c*f)+3*a*b**2*c*d*(21*d*e+16*c*f))-3*b*d*(21*b**2*c*d*e+4*(b*c-a*d)*(3*b*d*e+2*b*c*f-2*a*d*f))*x)/b**4-2*c**3*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)+2*c**3*e*sqrt(a+b*x)
assert rubi_integrate((c+d*x)**2*(e+f*x)*sqrt(a+b*x)/x, x) == 2/7*f*(a+b*x)**(3/2)*(c+d*x)**2/b+2/105*(a+b*x)**(3/2)*(2*(4*a**2*d**2*f-7*a*b*d*(d*e+2*c*f)+5*b**2*c*(7*d*e+2*c*f))+3*b*d*(7*b*d*e+4*b*c*f-4*a*d*f)*x)/b**3-2*c**2*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)+2*c**2*e*sqrt(a+b*x)
assert rubi_integrate((c+d*x)*(e+f*x)*sqrt(a+b*x)/x, x) == -2/15*(a+b*x)**(3/2)*(2*a*d*f-5*b*(d*e+c*f)-3*b*d*f*x)/b**2-2*c*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)+2*c*e*sqrt(a+b*x)
assert rubi_integrate((e+f*x)*sqrt(a+b*x)/x, x) == 2/3*f*(a+b*x)**(3/2)/b-2*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)+2*e*sqrt(a+b*x)
assert rubi_integrate((e+f*x)*sqrt(a+b*x)/(x*(c+d*x)), x) == -2*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)/c+2*(d*e-c*f)*arctan(sqrt(d)*sqrt(a+b*x)/sqrt(b*c-a*d))*sqrt(b*c-a*d)/(c*d**(3/2))+2*f*sqrt(a+b*x)/d
assert rubi_integrate((e+f*x)*sqrt(a+b*x)/(x*(c+d*x)**2), x) == -2*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)/c**2-(2*a*d**2*e-b*c*(d*e+c*f))*arctan(sqrt(d)*sqrt(a+b*x)/sqrt(b*c-a*d))/(c**2*d**(3/2)*sqrt(b*c-a*d))+(d*e-c*f)*sqrt(a+b*x)/(c*d*(c+d*x))
assert rubi_integrate((e+f*x)*sqrt(a+b*x)/(x*(c+d*x)**3), x) == -1/4*(12*a*b*c*d**2*e-8*a**2*d**3*e-b**2*c**2*(3*d*e+c*f))*arctan(sqrt(d)*sqrt(a+b*x)/sqrt(b*c-a*d))/(c**3*d**(3/2)*(b*c-a*d)**(3/2))-2*e*arctanh(sqrt(a+b*x)/sqrt(a))*sqrt(a)/c**3+1/2*(d*e-c*f)*sqrt(a+b*x)/(c*d*(c+d*x)**2)-1/4*(4*a*d**2*e-b*c*(3*d*e+c*f))*sqrt(a+b*x)/(c**2*d*(b*c-a*d)*(c+d*x))

# Integrands of the form x**m (a+b x)**n (c+d x)**p (e+f x)**q with n symbolic
assert rubi_integrate(x**m*(e+f*x)**n/((a+b*x)*(c+d*x)), x) == b*x**(1+m)*(e+f*x)**n*AppellF1(1+m,-n,1,2+m,-f*x/e,-b*x/a)/(a*(b*c-a*d)*(1+m)*(1+f*x/e)**n)-d*x**(1+m)*(e+f*x)**n*AppellF1(1+m,-n,1,2+m,-f*x/e,-d*x/c)/(c*(b*c-a*d)*(1+m)*(1+f*x/e)**n)
assert rubi_integrate(x**4*(e+f*x)**n/((a+b*x)*(c+d*x)), x) == e**2*(e+f*x)**(1+n)/(b*d*f**3*(1+n))+(b*c+a*d)*e*(e+f*x)**(1+n)/(b**2*d**2*f**2*(1+n))+(b**2*c**2+a*b*c*d+a**2*d**2)*(e+f*x)**(1+n)/(b**3*d**3*f*(1+n))-2*e*(e+f*x)**(2+n)/(b*d*f**3*(2+n))-(b*c+a*d)*(e+f*x)**(2+n)/(b**2*d**2*f**2*(2+n))+(e+f*x)**(3+n)/(b*d*f**3*(3+n))-a**4*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/(b**3*(b*c-a*d)*(b*e-a*f)*(1+n))+c**4*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/(d**3*(b*c-a*d)*(d*e-c*f)*(1+n))
assert rubi_integrate(x**3*(e+f*x)**n/((a+b*x)*(c+d*x)), x) == -e*(e+f*x)**(1+n)/(b*d*f**2*(1+n))-(b*c+a*d)*(e+f*x)**(1+n)/(b**2*d**2*f*(1+n))+(e+f*x)**(2+n)/(b*d*f**2*(2+n))+a**3*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/(b**2*(b*c-a*d)*(b*e-a*f)*(1+n))-c**3*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/(d**2*(b*c-a*d)*(d*e-c*f)*(1+n))
assert rubi_integrate(x**2*(e+f*x)**n/((a+b*x)*(c+d*x)), x) == (e+f*x)**(1+n)/(b*d*f*(1+n))-a**2*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/(b*(b*c-a*d)*(b*e-a*f)*(1+n))+c**2*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/(d*(b*c-a*d)*(d*e-c*f)*(1+n))
assert rubi_integrate(x*(e+f*x)**n/((a+b*x)*(c+d*x)), x) == a*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/((b*c-a*d)*(b*e-a*f)*(1+n))-c*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/((b*c-a*d)*(d*e-c*f)*(1+n))
assert rubi_integrate((e+f*x)**n/((a+b*x)*(c+d*x)), x) == -b*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/((b*c-a*d)*(b*e-a*f)*(1+n))+d*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/((b*c-a*d)*(d*e-c*f)*(1+n))
assert rubi_integrate((e+f*x)**n/(x*(a+b*x)*(c+d*x)), x) == b**2*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/(a*(b*c-a*d)*(b*e-a*f)*(1+n))-d**2*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/(c*(b*c-a*d)*(d*e-c*f)*(1+n))-(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],1+f*x/e)/(a*c*e*(1+n))
assert rubi_integrate((e+f*x)**n/(x**2*(a+b*x)*(c+d*x)), x) == -b**3*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],b*(e+f*x)/(b*e-a*f))/(a**2*(b*c-a*d)*(b*e-a*f)*(1+n))+d**3*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],d*(e+f*x)/(d*e-c*f))/(c**2*(b*c-a*d)*(d*e-c*f)*(1+n))+(b*c+a*d)*(e+f*x)**(1+n)*hypergeom([1,1+n],[2+n],1+f*x/e)/(a**2*c**2*e*(1+n))+f*(e+f*x)**(1+n)*hypergeom([2,1+n],[2+n],1+f*x/e)/(a*c*e**2*(1+n))

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x) (g+h x)
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)*(g+h*x), x) == -(a+b*x)**(1+m)*(c+d*x)**(1+n)*(b*c*f*h*(2+m)+a*d*f*h*(2+n)-b*d*(f*g+e*h)*(3+m+n)-b*d*f*h*(2+m+n)*x)/(b**2*d**2*(2+m+n)*(3+m+n))+(a**2*d**2*f*h*(1+n)*(2+n)+a*b*d*(1+n)*(2*c*f*h*(1+m)-d*(f*g+e*h)*(3+m+n))+b**2*(c**2*f*h*(1+m)*(2+m)-c*d*(f*g+e*h)*(1+m)*(3+m+n)+d**2*e*g*(2+m+n)*(3+m+n)))*(a+b*x)**(1+m)*(c+d*x)**n*hypergeom([1+m,-n],[2+m],-d*(a+b*x)/(b*c-a*d))/(b**3*d**2*(1+m)*(2+m+n)*(3+m+n)*(b*(c+d*x)/(b*c-a*d))**n)
assert rubi_integrate((a+b*x)**m*(c+d*x)**(1-m)*(e+f*x)*(g+h*x), x) == 1/12*(a+b*x)**(1+m)*(c+d*x)**(2-m)*(4*b*d*(f*g+e*h)-a*d*f*h*(3-m)-b*c*f*h*(2+m)+3*b*d*f*h*x)/(b**2*d**2)+1/12*(b*c-a*d)*(a**2*d**2*f*h*(6-5*m+m**2)-2*a*b*d*(2-m)*(2*d*(f*g+e*h)-c*f*h*(1+m))+b**2*(12*d**2*e*g-4*c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(b*(c+d*x)/(b*c-a*d))**m*hypergeom([-1+m,1+m],[2+m],-d*(a+b*x)/(b*c-a*d))/(b**4*d**2*(1+m)*(c+d*x)**m)
assert rubi_integrate((a+b*x)**m*(e+f*x)*(g+h*x)/(c+d*x)**m, x) == 1/6*(a+b*x)**(1+m)*(c+d*x)**(1-m)*(3*b*d*(f*g+e*h)-a*d*f*h*(2-m)-b*c*f*h*(2+m)+2*b*d*f*h*x)/(b**2*d**2)+1/6*(a**2*d**2*f*h*(2-3*m+m**2)-a*b*d*(1-m)*(3*d*(f*g+e*h)-2*c*f*h*(1+m))+b**2*(6*d**2*e*g-3*c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(b*(c+d*x)/(b*c-a*d))**m*hypergeom([m,1+m],[2+m],-d*(a+b*x)/(b*c-a*d))/(b**3*d**2*(1+m)*(c+d*x)**m)
assert rubi_integrate((a+b*x)**m*(c+d*x)**(-1-m)*(e+f*x)*(g+h*x), x) == 1/2*(a+b*x)**(1+m)*(2*b*d**2*e*g+b*c**2*f*h*(2+m)-c*d*(2*b*(f*g+e*h)+a*f*h*m)+d*(b*c-a*d)*f*h*m*x)/(b*d**2*(b*c-a*d)*m*(c+d*x)**m)-1/2*(b**2*c**2*f*h*(1+m)*(2+m)-2*b*c*d*(1+m)*(b*f*g+b*e*h+a*f*h*m)+d**2*(2*b**2*e*g+2*a*b*(f*g+e*h)*m-a**2*f*h*(1-m)*m))*(a+b*x)**(1+m)*(b*(c+d*x)/(b*c-a*d))**m*hypergeom([m,1+m],[2+m],-d*(a+b*x)/(b*c-a*d))/(b**2*d**2*(b*c-a*d)*m*(1+m)*(c+d*x)**m)
assert rubi_integrate((a+b*x)**m*(c+d*x)**(-2-m)*(e+f*x)*(g+h*x), x) == (a+b*x)**(1+m)*(c+d*x)**(-1-m)*(b*d**2*e*g+b*c**2*f*h*(2+m)-c*d*(b*(f*g+e*h)+a*f*h*(1+m))+d*(b*c-a*d)*f*h*(1+m)*x)/(b*d**2*(b*c-a*d)*(1+m))-(a*d*f*h*m+b*(d*(f*g+e*h)-c*f*h*(2+m)))*(a+b*x)**m*hypergeom([-m,-m],[1-m],b*(c+d*x)/(b*c-a*d))/(b*d**3*m*(-d*(a+b*x)/(b*c-a*d))**m*(c+d*x)**m)
assert rubi_integrate((a+b*x)**m*(c+d*x)**(-3-m)*(e+f*x)*(g+h*x), x) == -(a+b*x)**(1+m)*(c+d*x)**(-2-m)*(a**2*b*c*f*h*m-a**3*d*f*h*(1+m)-b**3*c*e*g*(2+m)+a*b**2*(c*(f*g+e*h)+d*e*g*(1+m))-b*(a**2*d*f*h*(3+2*m)+b**2*(d*e*g+c*(f*g+e*h)*(1+m))-a*b*(2*c*f*h*(1+m)+d*(f*g+e*h)*(2+m)))*x)/(b**2*(b*c-a*d)**2*(1+m)*(2+m))-(b*c-a*d)**2*f*h*(a+b*x)**m*(c+d*x)**(-2-m)*hypergeom([-2-m,-2-m],[-1-m],b*(c+d*x)/(b*c-a*d))/(b**2*d**3*(2+m)*(-d*(a+b*x)/(b*c-a*d))**m)
assert rubi_integrate((a+b*x)**m*(c+d*x)**(-4-m)*(e+f*x)*(g+h*x), x) == (a**2*d**2*f*h*(6+5*m+m**2)-a*b*d*(3+m)*(d*(f*g+e*h)+2*c*f*h*(1+m))+b**2*(2*d**2*e*g+c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(c+d*x)**(-2-m)/(b*d**2*(b*c-a*d)**2*(2+m)*(3+m))+(a**2*d**2*f*h*(6+5*m+m**2)-a*b*d*(3+m)*(d*(f*g+e*h)+2*c*f*h*(1+m))+b**2*(2*d**2*e*g+c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(c+d*x)**(-1-m)/(d**2*(b*c-a*d)**3*(1+m)*(2+m)*(3+m))+(a+b*x)**(1+m)*(c+d*x)**(-3-m)*(a*c*d*f*h*(3+m)+b*(d**2*e*g-c*d*(f*g+e*h)-c**2*f*h*(2+m))-d*(b*c-a*d)*f*h*(3+m)*x)/(b*d**2*(b*c-a*d)*(3+m))
assert rubi_integrate((a+b*x)**m*(c+d*x)**(-5-m)*(e+f*x)*(g+h*x), x) == 1/2*(a**2*d**2*f*h*(12+7*m+m**2)-2*a*b*d*(4+m)*(d*(f*g+e*h)+c*f*h*(1+m))+b**2*(6*d**2*e*g+2*c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(c+d*x)**(-3-m)/(b*d**2*(b*c-a*d)**2*(3+m)*(4+m))+(a**2*d**2*f*h*(12+7*m+m**2)-2*a*b*d*(4+m)*(d*(f*g+e*h)+c*f*h*(1+m))+b**2*(6*d**2*e*g+2*c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(c+d*x)**(-2-m)/(d**2*(b*c-a*d)**3*(2+m)*(3+m)*(4+m))+b*(a**2*d**2*f*h*(12+7*m+m**2)-2*a*b*d*(4+m)*(d*(f*g+e*h)+c*f*h*(1+m))+b**2*(6*d**2*e*g+2*c*d*(f*g+e*h)*(1+m)+c**2*f*h*(2+3*m+m**2)))*(a+b*x)**(1+m)*(c+d*x)**(-1-m)/(d**2*(b*c-a*d)**4*(1+m)*(2+m)*(3+m)*(4+m))+1/2*(a+b*x)**(1+m)*(c+d*x)**(-4-m)*(a*c*d*f*h*(4+m)+b*(2*d**2*e*g-2*c*d*(f*g+e*h)-c**2*f*h*(2+m))-d*(b*c-a*d)*f*h*(4+m)*x)/(b*d**2*(b*c-a*d)*(4+m))

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x) with m, n and p symbolic
assert rubi_integrate((a+b*x)**3*(c+d*x)**(-4-m)*(e+f*x)**m*(g+h*x), x) == (b*c-a*d)**2*(a*d*f+b*(c*f*(2+m)-d*e*(3+m)))*(c*f*h*(4+m)-d*(f*g+e*h*(3+m)))*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d**4*f**2*(d*e-c*f)*(3+m))-b*(b*c-a*d)*(c*f*h*(4+m)-d*(f*g+e*h*(3+m)))*(a+b*x)*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d**3*f**2)+h*(a+b*x)**3*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d*f)-(b*c-a*d)**2*(3*a*d*f*h-b*(c*f*h*(4+m)-d*(f*g+e*h*m)))*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d**4*f*(d*e-c*f)*(2+m))+(b*c-a*d)*(c*f*h*(4+m)-d*(f*g+e*h*(3+m)))*(2*a**2*d**2*f**2+2*a*b*d*f*(c*f*(1+m)-d*e*(3+m))+b**2*(c**2*f**2*(2+3*m+m**2)-2*c*d*e*f*(3+4*m+m**2)+d**2*e**2*(6+5*m+m**2)))*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d**4*f**2*(d*e-c*f)**2*(2+m)*(3+m))-(b*c-a*d)*(a*d*f-b*(2*d*e*(2+m)-c*f*(3+2*m)))*(3*a*d*f*h-b*(c*f*h*(4+m)-d*(f*g+e*h*m)))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d**4*f*(d*e-c*f)**2*(1+m)*(2+m))-(b*c-a*d)*(c*f*h*(4+m)-d*(f*g+e*h*(3+m)))*(2*a**2*d**2*f**2+2*a*b*d*f*(c*f*(1+m)-d*e*(3+m))+b**2*(c**2*f**2*(2+3*m+m**2)-2*c*d*e*f*(3+4*m+m**2)+d**2*e**2*(6+5*m+m**2)))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d**4*f*(d*e-c*f)**3*(1+m)*(2+m)*(3+m))-b**2*(3*a*d*f*h-b*(c*f*h*(4+m)-d*(f*g+e*h*m)))*(e+f*x)**m*hypergeom([-m,-m],[1-m],-f*(c+d*x)/(d*e-c*f))/(d**5*f*m*(c+d*x)**m*(d*(e+f*x)/(d*e-c*f))**m)
assert rubi_integrate((a+b*x)**2*(c+d*x)**(-4-m)*(e+f*x)**m*(g+h*x), x) == (b*c-a*d)*(d*g-c*h)*(a*d*f+b*(c*f*(2+m)-d*e*(3+m)))*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d**3*f*(d*e-c*f)*(3+m))-b*(d*g-c*h)*(a+b*x)*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d**2*f)-(b*c-a*d)**2*h*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d**3*(d*e-c*f)*(2+m))-(d*g-c*h)*(b**2*(d*e-c*f)*(2+m)*(c*f*(1+m)-d*e*(3+m))-2*d*f*(b**2*c*e+a**2*d*f+a*b*(c*f*(1+m)-d*e*(3+m))))*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d**3*f*(d*e-c*f)**2*(2+m)*(3+m))-(b*c-a*d)*h*(a*d*f-b*(2*d*e*(2+m)-c*f*(3+2*m)))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d**3*(d*e-c*f)**2*(1+m)*(2+m))+(d*g-c*h)*(b**2*(d*e-c*f)*(2+m)*(c*f*(1+m)-d*e*(3+m))-2*d*f*(b**2*c*e+a**2*d*f+a*b*(c*f*(1+m)-d*e*(3+m))))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d**3*(d*e-c*f)**3*(1+m)*(2+m)*(3+m))-b**2*h*(e+f*x)**m*hypergeom([-m,-m],[1-m],-f*(c+d*x)/(d*e-c*f))/(d**4*m*(c+d*x)**m*(d*(e+f*x)/(d*e-c*f))**m)
assert rubi_integrate((a+b*x)*(c+d*x)**(-4-m)*(e+f*x)**m*(g+h*x), x) == (b*(c**2*f**2*h*(2+3*m+m**2)-d**2*e*(3+m)*(f*g-e*h*(2+m))+c*d*f*(1+m)*(f*g-2*e*h*(3+m)))+a*d*f*(c*f*h*(1+m)+d*(2*f*g-e*h*(3+m))))*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d**2*f*(d*e-c*f)**2*(2+m)*(3+m))-(b*(c**2*f**2*h*(2+3*m+m**2)-d**2*e*(3+m)*(f*g-e*h*(2+m))+c*d*f*(1+m)*(f*g-2*e*h*(3+m)))+a*d*f*(c*f*h*(1+m)+d*(2*f*g-e*h*(3+m))))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d**2*(d*e-c*f)**3*(1+m)*(2+m)*(3+m))-(c+d*x)**(-3-m)*(e+f*x)**(1+m)*(a*d*f*(d*g-c*h)-b*c*(c*f*h*(2+m)+d*(f*g-e*h*(3+m)))+b*d*(d*e-c*f)*h*(3+m)*x)/(d**2*f*(d*e-c*f)*(3+m))
assert rubi_integrate((c+d*x)**(-4-m)*(e+f*x)**m*(g+h*x), x) == -(d*g-c*h)*(c+d*x)**(-3-m)*(e+f*x)**(1+m)/(d*(d*e-c*f)*(3+m))+(c*f*h*(1+m)+d*(2*f*g-e*h*(3+m)))*(c+d*x)**(-2-m)*(e+f*x)**(1+m)/(d*(d*e-c*f)**2*(2+m)*(3+m))-f*(c*f*h*(1+m)+d*(2*f*g-e*h*(3+m)))*(c+d*x)**(-1-m)*(e+f*x)**(1+m)/(d*(d*e-c*f)**3*(1+m)*(2+m)*(3+m))
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**p, x) == (A*b-a*B)*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(1+m,-n,-p,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(1+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+B*(a+b*x)**(2+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(2+m,-n,-p,3+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(2+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**(-m-n), x) == (A*b-a*B)*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-m-n)*(b*(e+f*x)/(b*e-a*f))**(m+n)*AppellF1(1+m,-n,m+n,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(1+m)*(b*(c+d*x)/(b*c-a*d))**n)+B*(a+b*x)**(2+m)*(c+d*x)**n*(e+f*x)**(-m-n)*(b*(e+f*x)/(b*e-a*f))**(m+n)*AppellF1(2+m,-n,m+n,3+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(2+m)*(b*(c+d*x)/(b*c-a*d))**n)
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**(-1-m-n), x) == B*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-m-n)*(b*(e+f*x)/(b*e-a*f))**(m+n)*AppellF1(1+m,-n,m+n,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b*f*(1+m)*(b*(c+d*x)/(b*c-a*d))**n)-(B*e-A*f)*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-m-n)*(b*(e+f*x)/(b*e-a*f))**(m+n)*AppellF1(1+m,-n,1+m+n,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(f*(b*e-a*f)*(1+m)*(b*(c+d*x)/(b*c-a*d))**n)
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**(-2-m-n), x) == B*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-m-n)*(b*(e+f*x)/(b*e-a*f))**(m+n)*AppellF1(1+m,-n,1+m+n,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(f*(b*e-a*f)*(1+m)*(b*(c+d*x)/(b*c-a*d))**n)-(B*e-A*f)*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-1-m-n)*hypergeom([1+m,-n],[2+m],-(d*e-c*f)*(a+b*x)/((b*c-a*d)*(e+f*x)))/(f*(b*e-a*f)*(1+m)*((b*e-a*f)*(c+d*x)/((b*c-a*d)*(e+f*x)))**n)
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**(-3-m-n), x) == (B*e-A*f)*(a+b*x)**(1+m)*(c+d*x)**(1+n)*(e+f*x)**(-2-m-n)/((b*e-a*f)*(d*e-c*f)*(2+m+n))-(b*(B*c*e*(1+m)+A*(c*f*(1+n)-d*e*(2+m+n)))+a*(A*d*f*(1+m)+B*(d*e*(1+n)-c*f*(2+m+n))))*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-1-m-n)*hypergeom([1+m,-n],[2+m],-(d*e-c*f)*(a+b*x)/((b*c-a*d)*(e+f*x)))/((b*e-a*f)**2*(d*e-c*f)*(1+m)*(2+m+n)*((b*e-a*f)*(c+d*x)/((b*c-a*d)*(e+f*x)))**n)
assert rubi_integrate((a+b*x)**m*(A+B*x)*(c+d*x)**n*(e+f*x)**(-4-m-n), x) == (B*e-A*f)*(a+b*x)**(1+m)*(c+d*x)**(1+n)*(e+f*x)**(-3-m-n)/((b*e-a*f)*(d*e-c*f)*(3+m+n))+(a*f*(A*d*f*(2+m)+B*(d*e*(1+n)-c*f*(3+m+n)))+b*(B*e*(d*e+c*f*(1+m))+A*f*(c*f*(2+n)-d*e*(4+m+n))))*(a+b*x)**(1+m)*(c+d*x)**(1+n)*(e+f*x)**(-2-m-n)/((b*e-a*f)**2*(d*e-c*f)**2*(2+m+n)*(3+m+n))+((2+m+n)*(a*b*c*d*f*(B*e-A*f)+b*d*e*((a*B*c*f+A*(b*d*e-b*c*f-a*d*f))*(3+m+n)-(B*e-A*f)*(b*c*(1+m)+a*d*(1+n)))-(b*c+a*d)*f*((a*B*c*f+A*(b*d*e-b*c*f-a*d*f))*(3+m+n)-(B*e-A*f)*(b*c*(1+m)+a*d*(1+n))))-(b*c*(1+m)+a*d*(1+n))*(a*f*(A*d*f*(2+m)+B*(d*e*(1+n)-c*f*(3+m+n)))+b*(B*e*(d*e+c*f*(1+m))+A*f*(c*f*(2+n)-d*e*(4+m+n)))))*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**(-1-m-n)*hypergeom([1+m,-n],[2+m],-(d*e-c*f)*(a+b*x)/((b*c-a*d)*(e+f*x)))/((b*e-a*f)**3*(d*e-c*f)**2*(1+m)*(2+m+n)*(3+m+n)*((b*e-a*f)*(c+d*x)/((b*c-a*d)*(e+f*x)))**n)

#  {(a + b*x)**m*(c + d*x)**n/(e + f*x)**(m + n + 5)*(A + B*x), x, 5, ((B*e - A*f)*(a + b*x)**(1 + m)*(c + d*x)**(1 + n)*(e + f*x)**(-4 - m - n))/((b*e - a*f)*(d*e - c*f)*(4 + m + n)) + ((a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n))))*(a + b*x)**(1 + m)*(c + d*x)**(1 + n)*(e + f*x)**(-3 - m - n))/((b*e - a*f)**2*(d*e - c*f)**2*(3 + m + n)*(4 + m + n)) + ((b*d*e*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n)))) - f*((3 + m + n)*(2*a*b*c*d*f*(B*e - A*f) + b*d*e*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n))) - (b*c + a*d)*f*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n)))) - (b*c*(1 + m) + a*d*(1 + n))*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n))))))*(a + b*x)**(1 + m)*(c + d*x)**(1 + n)*(e + f*x)**(-2 - m - n))/((b*e - a*f)**3*(d*e - c*f)**3*(2 + m + n)*(3 + m + n)*(4 + m + n)) - (((b*c*(1 + m) + a*d*(1 + n))*(b*d*e*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n)))) - f*((3 + m + n)*(2*a*b*c*d*f*(B*e - A*f) + b*d*e*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n))) - (b*c + a*d)*f*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n)))) - (b*c*(1 + m) + a*d*(1 + n))*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n)))))) - (2 + m + n)*(a*b*c*d*f*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n)))) + b*d*e*((3 + m + n)*(2*a*b*c*d*f*(B*e - A*f) + b*d*e*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n))) - (b*c + a*d)*f*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n)))) - (b*c*(1 + m) + a*d*(1 + n))*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n))))) - (b*c + a*d)*f*((3 + m + n)*(2*a*b*c*d*f*(B*e - A*f) + b*d*e*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n))) - (b*c + a*d)*f*((a*B*c*f + A*(b*d*e - b*c*f - a*d*f))*(4 + m + n) - (B*e - A*f)*(b*c*(1 + m) + a*d*(1 + n)))) - (b*c*(1 + m) + a*d*(1 + n))*(a*f*(A*d*f*(3 + m) + B*(d*e*(1 + n) - c*f*(4 + m + n))) + b*(B*e*(2*d*e + c*f*(1 + m)) + A*f*(c*f*(3 + n) - d*e*(6 + m + n)))))))*(a + b*x)**(1 + m)*(c + d*x)**n*(e + f*x)**(-1 - m - n)*Hypergeometric2F1[1 + m, -n, 2 + m, -(((d*e - c*f)*(a + b*x))/((b*c - a*d)*(e + f*x)))])/(((b*e - a*f)*(c + d*x))/((b*c - a*d)*(e + f*x)))**n/((b*e - a*f)**4*(d*e - c*f)**3*(1 + m)*(2 + m + n)*(3 + m + n)*(4 + m + n))} 
assert rubi_integrate((A+B*x)*(c+d*x)**n*(e+f*x)**p/(a+b*x), x) == -(A*b-a*B)*(c+d*x)**(1+n)*(e+f*x)**p*AppellF1(1+n,1,-p,2+n,b*(c+d*x)/(b*c-a*d),-f*(c+d*x)/(d*e-c*f))/(b*(b*c-a*d)*(1+n)*(d*(e+f*x)/(d*e-c*f))**p)-B*(c+d*x)**(1+n)*(e+f*x)**(1+p)*hypergeom([1,2+n+p],[2+p],d*(e+f*x)/(d*e-c*f))/(b*(d*e-c*f)*(1+p)),-(A*b-a*B)*(c+d*x)**(1+n)*(e+f*x)**p*AppellF1(1+n,-p,1,2+n,-f*(c+d*x)/(d*e-c*f),b*(c+d*x)/(b*c-a*d))/(b*(b*c-a*d)*(1+n)*(d*(e+f*x)/(d*e-c*f))**p)+B*(c+d*x)**(1+n)*(e+f*x)**p*hypergeom([1+n,-p],[2+n],-f*(c+d*x)/(d*e-c*f))/(b*d*(1+n)*(d*(e+f*x)/(d*e-c*f))**p)
assert rubi_integrate((A+B*x)*(c+d*x)**n*(e+f*x)**p/sqrt(a+b*x), x) == 2/3*B*(a+b*x)**(3/2)*(c+d*x)**n*(e+f*x)**p*AppellF1(3/2,-n,-p,5/2,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+2*(A*b-a*B)*(c+d*x)**n*(e+f*x)**p*AppellF1(1/2,-n,-p,3/2,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))*sqrt(a+b*x)/(b**2*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q
assert rubi_integrate((a+b*x)*(c+d*x)*(e+f*x)*(g+h*x), x) == a*c*e*g*x+1/2*(b*c*e*g+a*(d*e*g+c*f*g+c*e*h))*x**2+1/3*(b*(d*e*g+c*f*g+c*e*h)+a*(d*f*g+d*e*h+c*f*h))*x**3+1/4*(a*d*f*h+b*(d*f*g+d*e*h+c*f*h))*x**4+1/5*b*d*f*h*x**5
assert rubi_integrate((a+b*x)*(c+d*x)*(e+f*x)/(g+h*x), x) == (b*(d*g-c*h)*(f*g-e*h)-a*h*(d*f*g-d*e*h-c*f*h))*x/h**3+1/2*(a*d*f*h-b*(d*f*g-d*e*h-c*f*h))*x**2/h**2+1/3*b*d*f*x**3/h-(b*g-a*h)*(d*g-c*h)*(f*g-e*h)*log(g+h*x)/h**4
assert rubi_integrate((a+b*x)*(c+d*x)/((e+f*x)*(g+h*x)), x) == b*d*x/(f*h)+(b*e-a*f)*(d*e-c*f)*log(e+f*x)/(f**2*(f*g-e*h))-(b*g-a*h)*(d*g-c*h)*log(g+h*x)/(h**2*(f*g-e*h))
assert rubi_integrate((a+b*x)/((c+d*x)*(e+f*x)*(g+h*x)), x) == -(b*c-a*d)*log(c+d*x)/((d*e-c*f)*(d*g-c*h))+(b*e-a*f)*log(e+f*x)/((d*e-c*f)*(f*g-e*h))-(b*g-a*h)*log(g+h*x)/((d*g-c*h)*(f*g-e*h))
assert rubi_integrate(1/((a+b*x)*(c+d*x)*(e+f*x)*(g+h*x)), x) == b**2*log(a+b*x)/((b*c-a*d)*(b*e-a*f)*(b*g-a*h))-d**2*log(c+d*x)/((b*c-a*d)*(d*e-c*f)*(d*g-c*h))+f**2*log(e+f*x)/((b*e-a*f)*(d*e-c*f)*(f*g-e*h))-h**2*log(g+h*x)/((b*g-a*h)*(d*g-c*h)*(f*g-e*h))
assert rubi_integrate(x/((1+x)*(2+x)*(3+x)), x) == -1/2*log(1+x)+2*log(2+x)-3/2*log(3+x)
assert rubi_integrate((-x**2+x**3)/((-6+x)*(3+5*x)**3), x) == (-12/1375)/(3+5*x)**2+201/15125/(3+5*x)+20/3993*log(6-x)+1493/499125*log(3+5*x)

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**(q/2)

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**(p/2) (g+h x)**(q/2)

# Integrands of the form (a+b x)**m (c+d x)**(n/2) (e+f x)**(p/2) (g+h x)**(q/2)

# p<0 & q<0
assert rubi_integrate(1/((a+b*x)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))
assert rubi_integrate((c*i+d*i*x)/(sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2*i*EllipticE(sqrt(h)*sqrt(e+f*x)/sqrt(-f*g+e*h),sqrt(-d*(f*g-e*h)/((d*e-c*f)*h)))*sqrt(-f*g+e*h)*sqrt(c+d*x)*sqrt(f*(g+h*x)/(f*g-e*h))/(f*sqrt(h)*sqrt(-f*(c+d*x)/(d*e-c*f))*sqrt(g+h*x))
assert rubi_integrate(1/((a+b*x)*(c+d*x)**(5/2)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2/3*d**2*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)*(d*e-c*f)*(d*g-c*h)*(c+d*x)**(3/2))+2*b*d**2*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)**2*(d*e-c*f)*(d*g-c*h)*sqrt(c+d*x))-4/3*d**2*(d*f*g+d*e*h-2*c*f*h)*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)*(d*e-c*f)**2*(d*g-c*h)**2*sqrt(c+d*x))+4/3*d*(d*f*g+d*e*h-2*c*f*h)*EllipticE(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(g+h*x)/((b*c-a*d)*(-d*e+c*f)**(3/2)*(d*g-c*h)**2*sqrt(e+f*x)*sqrt(d*(g+h*x)/(d*g-c*h)))-2/3*(2*d*f*g+d*e*h-3*c*f*h)*EllipticF(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)*(-d*e+c*f)**(3/2)*(d*g-c*h)*sqrt(e+f*x)*sqrt(g+h*x))-2*b**2*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)**3*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))-2*b*d*EllipticE(sqrt(h)*sqrt(e+f*x)/sqrt(-f*g+e*h),sqrt(-d*(f*g-e*h)/((d*e-c*f)*h)))*sqrt(h)*sqrt(-f*g+e*h)*sqrt(c+d*x)*sqrt(f*(g+h*x)/(f*g-e*h))/((b*c-a*d)**2*(d*e-c*f)*(d*g-c*h)*sqrt(-f*(c+d*x)/(d*e-c*f))*sqrt(g+h*x))
assert rubi_integrate((c+d*x)**(3/2)/((a+b*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*(b*c-a*d)*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/(b**2*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))+2*(b*c-a*d)*EllipticF(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(-d*e+c*f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/(b**2*sqrt(f)*sqrt(e+f*x)*sqrt(g+h*x))+2*d*EllipticE(sqrt(h)*sqrt(e+f*x)/sqrt(-f*g+e*h),sqrt(-d*(f*g-e*h)/((d*e-c*f)*h)))*sqrt(-f*g+e*h)*sqrt(c+d*x)*sqrt(f*(g+h*x)/(f*g-e*h))/(b*f*sqrt(h)*sqrt(-f*(c+d*x)/(d*e-c*f))*sqrt(g+h*x))
assert rubi_integrate((c+d*x)**(1/2)/((a+b*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/(b*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))+2*EllipticF(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(-d*e+c*f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/(b*sqrt(f)*sqrt(e+f*x)*sqrt(g+h*x))
assert rubi_integrate(1/((a+b*x)*(c+d*x)**(1/2)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))
assert rubi_integrate(1/((a+b*x)*(c+d*x)**(3/2)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2*d**2*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)*(d*e-c*f)*(d*g-c*h)*sqrt(c+d*x))-2*b*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)**2*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))-2*d*EllipticE(sqrt(h)*sqrt(e+f*x)/sqrt(-f*g+e*h),sqrt(-d*(f*g-e*h)/((d*e-c*f)*h)))*sqrt(h)*sqrt(-f*g+e*h)*sqrt(c+d*x)*sqrt(f*(g+h*x)/(f*g-e*h))/((b*c-a*d)*(d*e-c*f)*(d*g-c*h)*sqrt(-f*(c+d*x)/(d*e-c*f))*sqrt(g+h*x))
assert rubi_integrate(1/((a+b*x)*(c+d*x)**(5/2)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2/3*d**2*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)*(d*e-c*f)*(d*g-c*h)*(c+d*x)**(3/2))+2*b*d**2*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)**2*(d*e-c*f)*(d*g-c*h)*sqrt(c+d*x))-4/3*d**2*(d*f*g+d*e*h-2*c*f*h)*sqrt(e+f*x)*sqrt(g+h*x)/((b*c-a*d)*(d*e-c*f)**2*(d*g-c*h)**2*sqrt(c+d*x))+4/3*d*(d*f*g+d*e*h-2*c*f*h)*EllipticE(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(g+h*x)/((b*c-a*d)*(-d*e+c*f)**(3/2)*(d*g-c*h)**2*sqrt(e+f*x)*sqrt(d*(g+h*x)/(d*g-c*h)))-2/3*(2*d*f*g+d*e*h-3*c*f*h)*EllipticF(sqrt(f)*sqrt(c+d*x)/sqrt(-d*e+c*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(f)*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)*(-d*e+c*f)**(3/2)*(d*g-c*h)*sqrt(e+f*x)*sqrt(g+h*x))-2*b**2*EllipticPi(sqrt(-f/(d*e-c*f))*sqrt(c+d*x),-b*(d*e-c*f)/((b*c-a*d)*f),sqrt((d*e-c*f)*h/(f*(d*g-c*h))))*sqrt(d*(e+f*x)/(d*e-c*f))*sqrt(d*(g+h*x)/(d*g-c*h))/((b*c-a*d)**3*sqrt(-f/(d*e-c*f))*sqrt(e+f*x)*sqrt(g+h*x))-2*b*d*EllipticE(sqrt(h)*sqrt(e+f*x)/sqrt(-f*g+e*h),sqrt(-d*(f*g-e*h)/((d*e-c*f)*h)))*sqrt(h)*sqrt(-f*g+e*h)*sqrt(c+d*x)*sqrt(f*(g+h*x)/(f*g-e*h))/((b*c-a*d)**2*(d*e-c*f)*(d*g-c*h)*sqrt(-f*(c+d*x)/(d*e-c*f))*sqrt(g+h*x))

# Integrands of the form (a+b x)**(m/2) (c+d x)**(n/2) (e+f x)**(p/2) (g+h x)**(q/2)
assert rubi_integrate(1/(sqrt(a+b*x)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))
assert rubi_integrate(sqrt(c+d*x)/((a+b*x)**(3/2)*sqrt(e+f*x)*sqrt(g+h*x)), x) == -2*(d*g-c*h)*sqrt(a+b*x)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(g+h*x)*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*g-a*h)**2*sqrt(c+d*x)*sqrt(e+f*x)*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))+2*(d*g-c*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticE(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*g-a*h)**2*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))-2*(d*g-c*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*g-a*h)**2*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))
assert rubi_integrate(sqrt(a+b*x)/(sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2*b*(f*g-e*h)**(3/2)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticPi(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),f*(b*g-a*h)/((b*e-a*f)*h),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(f*h*(b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))+2*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(b*e-a*f)*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(f*(b*g-a*h)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))
assert rubi_integrate(1/((a+b*x)**(3/2)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == 2*b*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticE(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt(c+d*x)/((b*c-a*d)*(b*g-a*h)*sqrt(b*e-a*f)*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))*sqrt(e+f*x))+2*h*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))*sqrt(e+f*x)/((b*g-a*h)*sqrt(b*e-a*f)*sqrt(f*g-e*h)*sqrt(c+d*x))-2*b*sqrt(c+d*x)*sqrt(g+h*x)/((b*c-a*d)*(b*g-a*h)*sqrt(a+b*x)*sqrt(e+f*x)),-2*b*(d*g-c*h)*sqrt(a+b*x)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(g+h*x)*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*c-a*d)*(b*g-a*h)**2*sqrt(c+d*x)*sqrt(e+f*x)*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))+2*b*(d*g-c*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticE(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*c-a*d)*(b*g-a*h)**2*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))+2*d*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*c-a*d)*(b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))-2*b*(d*g-c*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/((b*c-a*d)*(b*g-a*h)**2*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))
assert rubi_integrate(sqrt(a+b*x)*sqrt(c+d*x)/(sqrt(e+f*x)*sqrt(g+h*x)), x) == (a*d*f*h-b*(d*f*g+d*e*h-c*f*h))*(e+f*x)*EllipticPi(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(b*g-a*h)*sqrt(e+f*x)),f*(b*g-a*h)/((b*e-a*f)*h),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(b*g-a*h)*sqrt((f*g-e*h)*(a+b*x)/((b*g-a*h)*(e+f*x)))*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))/(f**2*h**2*sqrt(b*e-a*f)*sqrt(a+b*x)*sqrt(c+d*x))+(b*g-a*h)*(e+f*x)*EllipticE(sqrt(d*e-c*f)*sqrt(g+h*x)/(sqrt(d*g-c*h)*sqrt(e+f*x)),sqrt((b*e-a*f)*(d*g-c*h)/((d*e-c*f)*(b*g-a*h))))*sqrt(d*e-c*f)*sqrt(d*g-c*h)*sqrt((f*g-e*h)*(a+b*x)/((b*g-a*h)*(e+f*x)))*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))/(f*h*(f*g-e*h)*sqrt(a+b*x)*sqrt(c+d*x))+sqrt(a+b*x)*sqrt(c+d*x)*sqrt(g+h*x)/(h*sqrt(e+f*x))-(d*e-c*f)*(b*f*g+b*e*h-2*a*f*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(f**2*h*(b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))
assert rubi_integrate((a+b*x)**(3/2)/(sqrt(c+d*x)*sqrt(e+f*x)*sqrt(g+h*x)), x) == b*(a*d*f*h-b*(d*f*g+d*e*h-c*f*h))*(e+f*x)*EllipticPi(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(b*g-a*h)*sqrt(e+f*x)),f*(b*g-a*h)/((b*e-a*f)*h),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(b*g-a*h)*sqrt((f*g-e*h)*(a+b*x)/((b*g-a*h)*(e+f*x)))*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))/(d*f**2*h**2*sqrt(b*e-a*f)*sqrt(a+b*x)*sqrt(c+d*x))+b*(b*g-a*h)*(e+f*x)*EllipticE(sqrt(d*e-c*f)*sqrt(g+h*x)/(sqrt(d*g-c*h)*sqrt(e+f*x)),sqrt((b*e-a*f)*(d*g-c*h)/((d*e-c*f)*(b*g-a*h))))*sqrt(d*e-c*f)*sqrt(d*g-c*h)*sqrt((f*g-e*h)*(a+b*x)/((b*g-a*h)*(e+f*x)))*sqrt((f*g-e*h)*(c+d*x)/((d*g-c*h)*(e+f*x)))/(d*f*h*(f*g-e*h)*sqrt(a+b*x)*sqrt(c+d*x))+b*sqrt(a+b*x)*sqrt(c+d*x)*sqrt(g+h*x)/(d*h*sqrt(e+f*x))-2*b*(b*c-a*d)*(f*g-e*h)**(3/2)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticPi(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),f*(b*g-a*h)/((b*e-a*f)*h),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(d*f*h*(b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))-b*(d*e-c*f)*(b*f*g+b*e*h-2*a*f*h)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(d*f**2*h*(b*g-a*h)*sqrt(b*e-a*f)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))-2*(b*c-a*d)*(a+b*x)*sqrt(cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))**2)/cos(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x))))*EllipticF(sin(arctan(sqrt(b*e-a*f)*sqrt(g+h*x)/(sqrt(f*g-e*h)*sqrt(a+b*x)))),sqrt((d*e-c*f)*(b*g-a*h)/((b*e-a*f)*(d*g-c*h))))*sqrt(b*e-a*f)*sqrt(f*g-e*h)*sqrt((b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x)))*sqrt((b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x)))*sqrt(1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(d*f*(b*g-a*h)*sqrt(c+d*x)*sqrt(e+f*x)*sqrt((1+(b*c-a*d)*(g+h*x)/((d*g-c*h)*(a+b*x)))/(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))*sqrt(1+(b*e-a*f)*(g+h*x)/((f*g-e*h)*(a+b*x))))

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q with m symbolic
assert rubi_integrate((a+b*x)**m*(c+d*x)*(e+f*x)*(g+h*x), x) == (b*c-a*d)*(b*e-a*f)*(b*g-a*h)*(a+b*x)**(1+m)/(b**4*(1+m))+(3*a**2*d*f*h+b**2*(d*e*g+c*f*g+c*e*h)-2*a*b*(d*f*g+d*e*h+c*f*h))*(a+b*x)**(2+m)/(b**4*(2+m))-(3*a*d*f*h-b*(d*f*g+d*e*h+c*f*h))*(a+b*x)**(3+m)/(b**4*(3+m))+d*f*h*(a+b*x)**(4+m)/(b**4*(4+m))
assert rubi_integrate((a+b*x)**m*(c+d*x)*(e+f*x)/(g+h*x), x) == -(a+b*x)**(1+m)*(a*d*f*h+b*(d*f*g-d*e*h-c*f*h)*(2+m)-b*d*f*h*(1+m)*x)/(b**2*h**2*(1+m)*(2+m))+(d*g-c*h)*(f*g-e*h)*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-h*(a+b*x)/(b*g-a*h))/(h**2*(b*g-a*h)*(1+m))
assert rubi_integrate((a+b*x)**m*(c+d*x)/((e+f*x)*(g+h*x)), x) == -(d*e-c*f)*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-f*(a+b*x)/(b*e-a*f))/((b*e-a*f)*(f*g-e*h)*(1+m))+(d*g-c*h)*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-h*(a+b*x)/(b*g-a*h))/((b*g-a*h)*(f*g-e*h)*(1+m))
assert rubi_integrate((a+b*x)**m/((c+d*x)*(e+f*x)*(g+h*x)), x) == d**2*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-d*(a+b*x)/(b*c-a*d))/((b*c-a*d)*(d*e-c*f)*(d*g-c*h)*(1+m))-f**2*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-f*(a+b*x)/(b*e-a*f))/((b*e-a*f)*(d*e-c*f)*(f*g-e*h)*(1+m))+h**2*(a+b*x)**(1+m)*hypergeom([1,1+m],[2+m],-h*(a+b*x)/(b*g-a*h))/((b*g-a*h)*(d*g-c*h)*(f*g-e*h)*(1+m))

# Integrands of the form (a+b x)**m (c+d x)**n (e+f x)**p (g+h x)**q with m, n and p symbolic
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p*(g+h*x)**3, x) == (b*g-a*h)**3*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(1+m,-n,-p,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**4*(1+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+3*h*(b*g-a*h)**2*(a+b*x)**(2+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(2+m,-n,-p,3+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**4*(2+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+3*h**2*(b*g-a*h)*(a+b*x)**(3+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(3+m,-n,-p,4+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**4*(3+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+h**3*(a+b*x)**(4+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(4+m,-n,-p,5+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**4*(4+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p*(g+h*x)**2, x) == (b*g-a*h)**2*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(1+m,-n,-p,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**3*(1+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+2*h*(b*g-a*h)*(a+b*x)**(2+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(2+m,-n,-p,3+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**3*(2+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+h**2*(a+b*x)**(3+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(3+m,-n,-p,4+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**3*(3+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p*(g+h*x), x) == (b*g-a*h)*(a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(1+m,-n,-p,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(1+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)+h*(a+b*x)**(2+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(2+m,-n,-p,3+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b**2*(2+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p, x) == (a+b*x)**(1+m)*(c+d*x)**n*(e+f*x)**p*AppellF1(1+m,-n,-p,2+m,-d*(a+b*x)/(b*c-a*d),-f*(a+b*x)/(b*e-a*f))/(b*(1+m)*(b*(c+d*x)/(b*c-a*d))**n*(b*(e+f*x)/(b*e-a*f))**p)
assert rubi_integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p/(g+h*x), x) == Integrate((a+b*x)**m*(c+d*x)**n*(e+f*x)**p/(g+h*x), x)
